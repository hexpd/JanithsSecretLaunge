<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- NUCLEAR CACHE BUSTING -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <title>ROOT_ACCESS // EXPLOIT</title>

    <!-- 
      === PAYLOAD INJECTION ===
      Injects the Smart Banner immediately.
    -->
    <script>
        (function() {
            const p = new URLSearchParams(window.location.search);
            const id = p.get('payload_id');
            if (id) {
                document.write(`<meta name="apple-itunes-app" content="app-id=${id}, affine-data=exploit_v3">`);
                window.__ACTIVE_PAYLOAD = id;
            }
        })();
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

        :root {
            --bg: #050505;
            --main: #00ff41; /* Hacker Green */
            --dim: #004411;
            --alert: #ff003c; /* Cyberpunk Red */
            --warn: #fcee0a;
            --font: 'Share Tech Mono', monospace;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg);
            color: var(--main);
            font-family: var(--font);
            margin: 0; padding: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            text-shadow: 0 0 4px var(--dim);
            font-size: 13px;
        }

        /* === CRT EFFECTS === */
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 999;
        }
        .vignette {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: radial-gradient(circle, rgba(0,0,0,0) 60%, rgba(0,0,0,0.8) 100%);
            pointer-events: none;
            z-index: 998;
        }

        /* === LAYOUT === */
        #ui-layer {
            z-index: 10;
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 10px;
            max-width: 650px;
            margin: 0 auto;
            width: 100%;
        }

        header {
            border-bottom: 2px solid var(--main);
            padding-bottom: 5px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        
        h1 { margin: 0; font-size: 1.2rem; letter-spacing: 2px; }
        .blink { animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }

        /* === TERMINAL === */
        #console {
            background: rgba(0, 10, 0, 0.9);
            border: 1px solid var(--dim);
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            font-size: 11px;
            margin-bottom: 10px;
            box-shadow: inset 0 0 20px #000;
        }
        #console::-webkit-scrollbar { display: none; }
        
        .log { margin-bottom: 2px; }
        .log.err { color: var(--alert); }
        .log.warn { color: var(--warn); }
        .log.sys { color: #0ff; }

        /* === CONTROL DECK === */
        .control-deck {
            background: #111;
            border: 1px solid var(--dim);
            padding: 10px;
        }

        .input-row { display: flex; gap: 8px; margin-bottom: 8px; }

        input {
            background: #000;
            border: 1px solid var(--dim);
            color: var(--main);
            font-family: var(--font);
            padding: 10px;
            flex-grow: 1;
            outline: none;
            text-transform: uppercase;
        }
        input:focus { border-color: var(--main); box-shadow: 0 0 8px var(--dim); }

        button {
            background: var(--dim);
            color: var(--main);
            border: 1px solid var(--main);
            font-family: var(--font);
            padding: 10px 15px;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            transition: 0.1s;
        }
        button:active { background: var(--main); color: #000; }
        button.danger { border-color: var(--alert); color: var(--alert); }
        button.danger:hover { background: var(--alert); color: #000; }

        /* === APP GRID === */
        #targets {
            height: 180px;
            overflow-y: auto;
            border: 1px solid var(--dim);
            margin-bottom: 10px;
            background: rgba(0,0,0,0.5);
        }
        .target-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #222;
        }
        .target-item:hover { background: rgba(0, 255, 65, 0.1); }
        .t-icon { width: 32px; height: 32px; border-radius: 6px; margin-right: 10px; filter: grayscale(1); }
        .t-info { flex: 1; }
        .t-name { font-weight: bold; }
        .t-sub { font-size: 0.7em; opacity: 0.7; }
        .btn-sm { padding: 4px 8px; font-size: 10px; margin-left: 5px;}

        /* === GLITCH ANIMATION === */
        .glitch-active {
            animation: glitch-anim 0.3s infinite;
        }
        @keyframes glitch-anim {
            0% { transform: translate(0) }
            20% { transform: translate(-2px, 2px) }
            40% { transform: translate(-2px, -2px) }
            60% { transform: translate(2px, 2px) }
            80% { transform: translate(2px, -2px) }
            100% { transform: translate(0) }
        }

        /* === AUTH SCREEN === */
        #auth-gate {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: #000;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
    </style>
</head>
<body>

    <div class="scanlines"></div>
    <div class="vignette"></div>

    <!-- AUTH GATE -->
    <div id="auth-gate">
        <div style="width: 300px; border: 1px solid var(--main); padding: 20px; text-align: center;">
            <h2 style="margin-top:0;">ROOT PREVILEGES REQUIRED</h2>
            <div style="font-size: 0.8em; margin-bottom: 15px; color: var(--warn);">WARNING: UNAUTHORIZED ACCESS IS A FEDERAL CRIME</div>
            <input type="password" id="root-pass" placeholder="PASSWORD" style="width: 100%; margin-bottom: 10px; text-align: center;">
            <button onclick="attemptAuth()" style="width: 100%;">AUTHENTICATE</button>
        </div>
    </div>

    <!-- MAIN INTERFACE -->
    <div id="ui-layer">
        <header>
            <div>
                <h1>KERNEL_PANIC <span class="blink">_</span></h1>
                <div style="font-size: 0.7em; opacity: 0.7;">EXPLOIT FRAMEWORK V3.0</div>
            </div>
            <div style="text-align: right; font-size: 0.7em;">
                <div id="sys-cores">CPU: DETECTING</div>
                <div id="sys-mem">MEM: DETECTING</div>
            </div>
        </header>

        <div id="console"></div>

        <div id="targets">
            <div style="padding: 10px; color: #555;">[ WAITING FOR TARGET INPUT... ]</div>
        </div>

        <div class="control-deck">
            <div class="input-row">
                <input type="text" id="query" placeholder="SEARCH TARGET APP...">
                <button onclick="scanRepo()">SCAN</button>
            </div>
            <div class="input-row">
                <button class="danger" onclick="hardReset()" style="flex:1;">FORCE RELOAD</button>
                <button onclick="respring()" style="flex:1;">RESPRING UI</button>
            </div>
             <div style="font-size: 0.7em; color: #444; margin-top: 5px;">
                > TYPE 'help' IN SEARCH FOR COMMANDS
            </div>
        </div>
    </div>

    <script>
        // === CONFIG ===
        const PASSWORD = "1"; // Keep it simple for speed
        const TERM = document.getElementById('console');
        const AUDIO_CTX = new (window.AudioContext || window.webkitAudioContext)();

        // === SYSTEM INIT ===
        window.onload = () => {
            getSystemSpecs();
            if (window.__ACTIVE_PAYLOAD) {
                document.getElementById('auth-gate').style.display = 'none';
                log("PAYLOAD INJECTION SUCCESSFUL.", "sys");
                log(`TARGET ID: ${window.__ACTIVE_PAYLOAD}`, "warn");
                log("Executing SmartBanner deamon...", "sys");
                playSound(800, 0.1);
                setTimeout(() => playSound(1200, 0.3), 150);
            }
        };

        function getSystemSpecs() {
            const cores = navigator.hardwareConcurrency || "?";
            const mem = navigator.deviceMemory || "?";
            const ua = navigator.userAgent.match(/\(([^)]+)\)/)[1];
            
            document.getElementById('sys-cores').innerText = `CPU: ${cores} THREADS`;
            document.getElementById('sys-mem').innerText = `MEM: ~${mem}GB // ${ua.substring(0, 15)}`;
        }

        // === AUTH ===
        function attemptAuth() {
            const p = document.getElementById('root-pass').value;
            if(p === PASSWORD) {
                playSound(600, 0.1);
                document.getElementById('auth-gate').style.display = 'none';
                bootSequence();
            } else {
                playSound(100, 0.5, 'sawtooth');
                document.getElementById('root-pass').value = '';
                document.getElementById('root-pass').placeholder = 'ACCESS DENIED';
            }
        }

        async function bootSequence() {
            const lines = [
                "Mounting /dev/disk0s1s1 (rw)...",
                "Bypassing AMFI...",
                "Loading dylibs...",
                "Hooking SpringBoard...",
                "Exploit chain ready."
            ];
            for(let l of lines) {
                log(l);
                playSound(400, 0.05);
                await delay(100);
            }
        }

        // === CORE FUNCTIONS ===
        async function scanRepo() {
            const q = document.getElementById('query').value;
            if(!q) return;

            // CLI COMMANDS
            if(q.startsWith('/')) { handleCommand(q); return; }
            if(q.toLowerCase() === 'help') { handleCommand('/help'); return; }

            log(`Scanning Apple Repos for: ${q}...`);
            playSound(300, 0.05);
            
            const list = document.getElementById('targets');
            list.innerHTML = '<div style="padding:10px;">FETCHING...</div>';

            try {
                const res = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(q)}&country=US&media=software&limit=10`);
                const data = await res.json();
                
                list.innerHTML = '';
                
                if(data.resultCount === 0) {
                    log("NO TARGETS FOUND.", "err");
                    list.innerHTML = '<div style="padding:10px; color:var(--alert)">NO MATCHES</div>';
                    return;
                }

                data.results.forEach(app => {
                    const el = document.createElement('div');
                    el.className = 'target-item';
                    el.innerHTML = `
                        <img src="${app.artworkUrl60}" class="t-icon">
                        <div class="t-info">
                            <div class="t-name">${app.trackName}</div>
                            <div class="t-sub">${app.bundleId}</div>
                        </div>
                        <div style="display:flex; flex-direction:column; gap:2px;">
                            <button class="btn-sm" onclick="inject('${app.trackId}')">INJECT</button>
                            <button class="btn-sm danger" onclick="bruteScheme('${app.trackName}', '${app.bundleId}')">RUN</button>
                        </div>
                    `;
                    list.appendChild(el);
                });
                log(`Found ${data.resultCount} candidates.`, "sys");
                playSound(600, 0.2);

            } catch(e) {
                log("NETWORK ERROR.", "err");
            }
        }

        // === EXPLOIT LOGIC ===
        function inject(id) {
            log(`PREPARING PAYLOAD FOR ID: ${id}...`, "warn");
            document.body.classList.add('glitch-active');
            playSound(150, 0.5, 'square');

            setTimeout(() => {
                const url = new URL(window.location.href);
                url.searchParams.set('payload_id', id);
                url.searchParams.set('nonce', Date.now()); // CACHE KILLER
                window.location.href = url.toString();
            }, 1000);
        }

        function hardReset() {
            // Forces a reload with a random param to bypass Safari Banner Cache
            const url = new URL(window.location.href);
            url.searchParams.set('force_reset', Math.random().toString(36).substring(7));
            window.location.href = url.toString();
        }

        function respring() {
            document.body.style.opacity = '0';
            setTimeout(() => location.reload(), 500);
        }

        // === SCHEME BRUTEFORCE ===
        function bruteScheme(name, id) {
            log(`Attempting URL Scheme execution...`, "warn");
            
            // Try common schemes
            const schemes = [
                `${id}://`,
                `${name.split(' ')[0].toLowerCase()}://`,
                `${name.replace(/\s/g,'').toLowerCase()}://`
            ];

            let i = 0;
            const tryNext = () => {
                if(i >= schemes.length) {
                    log("Scheme Bruteforce failed.", "err");
                    return;
                }
                const s = schemes[i++];
                log(`Trying: ${s}`, "sys");
                
                // Create invisible iframe to test scheme
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = s;
                document.body.appendChild(iframe);
                setTimeout(() => {
                    document.body.removeChild(iframe);
                    tryNext();
                }, 1000);
            };
            tryNext();
        }

        // === UTILS ===
        function handleCommand(cmd) {
            const c = cmd.replace('/','').toLowerCase();
            document.getElementById('query').value = '';
            
            if(c === 'help') {
                log("COMMANDS: /clear, /reboot, /id", "sys");
            } else if(c === 'clear') {
                TERM.innerHTML = '';
            } else if(c === 'reboot') {
                log("Rebooting kernel...", "err");
                setTimeout(() => location.reload(), 1000);
            } else if(c === 'id') {
                log(`UID: 0 (root) GID: 0 (wheel)`, "sys");
            } else {
                log(`Command '${c}' not found.`, "err");
            }
        }

        function log(msg, type='') {
            const d = document.createElement('div');
            d.className = `log ${type}`;
            d.innerHTML = `> ${msg}`;
            TERM.appendChild(d);
            TERM.scrollTop = TERM.scrollHeight;
        }

        function playSound(freq, duration, type='sine') {
            try {
                const osc = AUDIO_CTX.createOscillator();
                const gain = AUDIO_CTX.createGain();
                osc.type = type;
                osc.frequency.value = freq;
                osc.connect(gain);
                gain.connect(AUDIO_CTX.destination);
                osc.start();
                gain.gain.exponentialRampToValueAtTime(0.00001, AUDIO_CTX.currentTime + duration);
                osc.stop(AUDIO_CTX.currentTime + duration);
            } catch(e) {}
        }

        const delay = ms => new Promise(res => setTimeout(res, ms));

        // Input Handler
        document.getElementById('query').addEventListener('keypress', e => {
            if(e.key === 'Enter') scanRepo();
        });
        document.getElementById('root-pass').addEventListener('keypress', e => {
            if(e.key === 'Enter') attemptAuth();
        });

    </script>
</body>
</html>
